/**
 * @license jq-arcs v1.0.0
 * (c) 2018 Finsi, Inc.
 */

!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("svgjs")):"function"==typeof define&&define.amd?define(["exports","svgjs"],s):s(t.jqArcs={},null)}(this,function(t,s){"use strict";var i,e="default"in s?s.default:s;(i=t.ArcsEvents||(t.ArcsEvents={})).beforeActivateItem="arcs:beforeActivateItem",i.activateItem="arcs:activateItem",i.complete="arcs:complete";var o=function(){return function(t){void 0===t&&(t={}),void 0!=t.color&&(this.color=t.color),void 0!=t.start&&(this.start=t.start),void 0!=t.end&&(this.end=t.end),void 0!=t.stroke&&(this.stroke=t.stroke),void 0!=t.d&&(this.d=t.d),void 0!=t.arc&&(this.arc=t.arc),void 0!=t.totalLength&&(this.totalLength=t.totalLength)}}(),a=function(){return function(t){void 0===t&&(t={}),void 0!=t.$item&&(this.$item=t.$item),void 0!=t.back&&(t.back instanceof o?this.back=t.back:this.back=new o(t.back)),void 0!=t.mid&&(t.mid instanceof o?this.mid=t.mid:this.mid=new o(t.mid)),void 0!=t.fill&&(t.fill instanceof o?this.fill=t.fill:this.fill=new o(t.fill)),void 0!=t.group&&(this.group=t.group),void 0!=t.disabled&&(this.disabled=t.disabled),void 0!=t.activated&&(this.activated=t.activated)}}(),r=e||s,n=function(){function s(){this._activated=0,this._current=-1}return s.prototype._create=function(){this.element.addClass(this.options.classes.root),this._svg=r(this.element.get(0)),this._position=this.options.viewBox/2,this._radius=this.options.viewBox/2-this.options.stroke,this._svg.viewbox(0,0,this.options.viewBox,this.options.viewBox),this.draw(!0)},s.prototype.draw=function(t){void 0===t&&(t=!1),t&&(this._findElements(),this._extractData(),this._activated=0,this._current=-1),this._draw(),this.options.lineal&&(t?this.next():this._updateCurrentItem())},s.prototype.next=function(){this.options.lineal&&(this._current++,this.setItemDisable(this._current,!1),this._updateCurrentItem())},s.prototype.setItemDisable=function(t,s){var i=this._items[t];i&&(i.disabled=s,s?(i.group.$node.addClass(this.options.classes.disabled),i.$item.addClass(this.options.classes.disabled)):(i.group.$node.removeClass(this.options.classes.disabled),i.$item.removeClass(this.options.classes.disabled)))},s.prototype.enableItem=function(t){this.setItemDisable(t,!1)},s.prototype.disableItem=function(t){this.setItemDisable(t,!0)},s.prototype.enable=function(){this._super&&this._super(),this.element.removeClass(this.options.classes.disabled)},s.prototype.disable=function(){this._super&&this._super(),this.element.addClass(this.options.classes.disabled)},s.prototype.activate=function(t){if(1!=this.options.disabled){var s=this._items[t];if(s&&1!=s.disabled)return s.group.$node.addClass(this.options.classes.activating),s.$item.addClass(this.options.classes.activating),s.group.off("click",this._onGroupClick),this._animate(s)}},s.prototype._findElements=function(){this._$items=this.element.find(this.options.selectors.item),this._$items.addClass(this.options.classes.item)},s.prototype._extractData=function(){for(var t=this._$items,s=[],i=this.options.limit,e=this.options.stroke,o=this.options.separation,r=this.options.back.border,n=this.options.mid.border,c=0,d=i/t.length,l=0,h=t.length;l<h;l++){var p=$(t[l]),u=this._calculateItemArcs(c,d,e,o,r,n),m=u.back,v=u.mid,f=u.fill;m=$.extend(!0,{},this.options.back,m),v=$.extend(!0,{},this.options.mid,v),f=$.extend(!0,{},this.options.fill,f);var _=new a({$item:p,back:m,mid:v,fill:f,disabled:this.options.lineal,activated:!1});s.push(_),c+=d}this._items=s},s.prototype._calculateItemArcs=function(t,s,i,e,o,a){var r=e/2,n=r+o,c=n+a,d=i-2*o;return{back:{start:t+r,end:t+s-r,stroke:i},mid:{start:t+n,end:t+s-n,stroke:d},fill:{start:t+c,end:t+s-c,stroke:d-2*a}}},s.prototype._updateCurrentItem=function(){if(this.options.lineal){var t=this._items[this._current-1];t&&(t.group.$node.removeClass(this.options.classes.current),t.$item.removeClass(this.options.classes.current));var s=this._items[this._current];s&&(s.group.$node.addClass(this.options.classes.current),s.$item.addClass(this.options.classes.current))}},s.prototype._getCreateOptions=function(){return{viewBox:200,limit:360,stroke:30,separation:10,selectors:{item:"[data-arcs-item]"},classes:{root:"jq-arcs",item:"jq-arcs__item",group:"jq-arcs__group",arc:"jq-arcs__arc",back:"jq-arcs__arc-back",mid:"jq-arcs__arc-mid",fill:"jq-arcs__arc-fill",disabled:"jq-arcs--disabled",activating:"jq-arcs--activating",activated:"jq-arcs--activated",current:"jq-arcs--current"},back:{color:"#000",border:2},mid:{color:"#fff",border:0},fill:{color:"#2196F3"},animation:{duration:800,ease:"<>",delay:0},lineal:!0}},s.prototype._draw=function(){if(this._draws)for(var t=this._draws,s=0,i=t.length;s<i;s++){(r=t[s]).remove()}this._draws=[];for(var e=this._items,o=0,a=e.length;o<a;o++){var r,n=(r=e[o]).back,c=r.mid,d=r.fill,l=this._svg.group();r.group=l,l.attr({class:this.options.classes.group}),n.d=this._describeArc(this._position,this._position,this._radius,n.start,n.end),c.d=this._describeArc(this._position,this._position,this._radius,c.start,c.end),d.d=this._describeArc(this._position,this._position,this._radius,d.start,d.end),n.arc=l.path(n.d).fill("none").stroke({width:n.stroke,color:this.options.back.color}).attr({class:this.options.classes.arc+" "+this.options.classes.back}),n.arc.$node=$(n.arc.node),c.arc=l.path(c.d).fill("none").stroke({width:c.stroke,color:this.options.mid.color}).attr({class:this.options.classes.arc+" "+this.options.classes.mid}),c.arc.$node=$(c.arc.node),d.arc=l.path(d.d).fill("none").stroke({width:d.stroke,color:this.options.fill.color}).attr({class:this.options.classes.arc+" "+this.options.classes.fill}),d.arc.$node=$(d.arc.node);var h=d.arc.node.getTotalLength();d.totalLength=h,d.arc.attr({"stroke-dasharray":h+" "+h,"stroke-dashoffset":1!=r.activated?-h:0}),l.on("click",this._onGroupClick.bind(this,o)),l.$node=$(l.node),this.setItemDisable(o,r.disabled),this._draws.push(l)}},s.prototype._onGroupClick=function(t){this.activate(t)},s.prototype._polarToCartesian=function(t,s,i,e){var o=(e-90)*Math.PI/180;return{x:t+i*Math.cos(o),y:s+i*Math.sin(o)}},s.prototype._describeArc=function(t,s,i,e,o){var a=this._polarToCartesian(t,s,i,o),r=this._polarToCartesian(t,s,i,e),n=o-e<=180?"0":"1";return["M",a.x,a.y,"A",i,i,0,n,0,r.x,r.y].join(" ")},s.prototype._onAnimationEnd=function(s,i){i.resolve(s),s.activated=!0,s.group.$node.removeClass(this.options.classes.activating),s.$item.removeClass(this.options.classes.activating),s.group.$node.addClass(this.options.classes.activated),s.$item.addClass(this.options.classes.activated),this._activated++,this.options.lineal&&this.next(),this.element.trigger(t.ArcsEvents.activateItem,[this,s]),this._activated==this._items.length&&this.element.trigger(t.ArcsEvents.complete,[this])},s.prototype._animate=function(s){var i=$.Deferred();return 1!=this.options.disabled&&s&&1!=s.disabled?(this.element.trigger(t.ArcsEvents.beforeActivateItem,[this,s]),s.fill.arc.animate(this.options.animation.duration,this.options.animation.ease,this.options.animation.delay).attr({"stroke-dashoffset":0}).afterAll(this._onAnimationEnd.bind(this,s,i))):i.rejectWith(this,[s]),i.promise()},s}();if(Object.hasOwnProperty("getOwnPropertyDescriptors")){for(var c={},d=Object.getOwnPropertyNames(n.prototype),l=0,h=d.length;l<h;l++){var p=d[l];c[p]=Object.getOwnPropertyDescriptor(n.prototype,p).value}$.widget("ui.arcs",c)}else $.widget("ui.arcs",n.prototype);t.ArcsItemSvg=o,t.ArcsItem=a,t.Arcs=n,Object.defineProperty(t,"__esModule",{value:!0})});
